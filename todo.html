<html>
<head>
	<link rel="stylesheet" href="todo.css" type="text/css" />
</head>

<script>
iter = 0;
addTask = function() {
	var item, list, row, val;
	list = document.getElementById("list");
	val = document.getElementById("newtask").value;
	checkbox = document.createElement("input");
	checkbox.setAttribute("type", "checkbox");

	item = document.createElement("li");
	item.appendChild(checkbox);
	text = document.createTextNode(val);
	item.appendChild(text);
	checkbox.id = iter;
	iter++;

	list.appendChild(item);

	checkbox.onclick = function() {
		item.style.textDecoration = "line-through";
		item.className = "done";
		saveList();
	}
	saveList();
}

saveList = function() {
	listy = [];
	allItems = document.querySelectorAll("li");
	for(i = 0; i < allItems.length; i++) {
		if (allItems[i].className != "done") {
			listy.push(allItems[i].innerText);
		}
	}
	localStorage.setItem("todoDatabase", JSON.stringify(listy));
}

loadList = function(){
	var listy,item, list, row, val;
	listy = localStorage.getItem("todoDatabase");
	listy = JSON.parse(listy);

	for(i = 0; i <= listy.length; i++){
		val = listy.shift();

		list = document.getElementById("list");
		checkbox = document.createElement("input");
		checkbox.setAttribute("type", "checkbox");

		item = document.createElement("li");
		item.appendChild(checkbox);
		text = document.createTextNode(val);
		item.appendChild(text);
		checkbox.id = iter;
		iter++;

		list.appendChild(item);

		checkbox.onclick = function() {
			item.style.textDecoration = "line-through";
			item.className = "done";
			saveList();
		}
	}
}

</script>

<body onload="loadList()">
	<ul id="list">
	</ul>
	<label for="newtask">New Task</label>
	<input id="newtask" type="text"></input>
	<button id="add" onclick="addTask();">Add Task</button>
</body>
</html>